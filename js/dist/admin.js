(()=>{var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var s in a)t.o(a,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:a[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};(()=>{"use strict";const e=flarum.core.compat["admin/app"];var a=t.n(e);function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,s(t,e)}const r=flarum.core.compat["common/components/Modal"];var o=t.n(r);const i=flarum.core.compat["common/components/Button"];var l=t.n(i);const u=flarum.core.compat["common/components/LoadingIndicator"];var d=t.n(u),c=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.entry=this.attrs.entry},a.className=function(){return"DeleteKnowledgeBaseEntryModal Modal--small"},a.title=function(){return"Confirm Deletion"},a.content=function(){var t=this;return m("div",{className:"Modal-body"},m("p",null,"Are you sure you want to delete this knowledge base entry? This action cannot be undone."),m("div",{className:"Form-group"},m(l(),{className:"Button Button--primary Button--danger",onclick:function(){t.attrs.onconfirm(),t.hide()}},"Delete")," ",m(l(),{className:"Button",onclick:function(){return t.hide()}},"Cancel")))},e}(o()),p=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var a=e.prototype;return a.oninit=function(e){var a,s,n,r,o;t.prototype.oninit.call(this,e),this.entry=this.attrs.entry,this.editedEntry={type:this.getEntryType(),question:this.entry.question||(null==(a=this.entry.attributes)?void 0:a.question)||"",answer:this.entry.answer||(null==(s=this.entry.attributes)?void 0:s.answer)||this.entry.content||(null==(n=this.entry.attributes)?void 0:n.content)||"",keywords:this.entry.keywords||(null==(r=this.entry.attributes)?void 0:r.keywords)||"",category_id:this.entry.category_id||(null==(o=this.entry.attributes)?void 0:o.category_id)||null},this.categories=this.attrs.categories||[]},a.getEntryType=function(){return this.entry.attributes&&this.entry.attributes.type?this.entry.attributes.type:this.entry.type&&"kb-entries"!==this.entry.type?this.entry.type:"qa"},a.className=function(){return"EditKnowledgeBaseEntryModal Modal--large"},a.title=function(){return"Edit Knowledge Base Entry"},a.content=function(){var t=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,"Type"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.editedEntry.type,onchange:function(e){t.editedEntry.type=e.target.value,m.redraw()}},m("option",{value:"qa"},"Q&A Type"),m("option",{value:"content"},"Content Type"))),m("div",{className:"helpText"},"Current type: ",this.editedEntry.type)),"qa"===this.editedEntry.type&&m("div",{className:"Form-group"},m("label",null,"Question"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",value:this.editedEntry.question,oninput:function(e){t.editedEntry.question=e.target.value}})),m("div",{className:"helpText"},"Current question: ",this.editedEntry.question||"(No question)")),"content"===this.editedEntry.type&&m("div",{className:"Form-group"},m("label",null,"Title (Optional)"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",value:this.editedEntry.question,placeholder:"Optional title for content entry",oninput:function(e){t.editedEntry.question=e.target.value}})),m("div",{className:"helpText"},"Adding a title helps the AI better match this content. If left empty, a title will be generated from the content.")),m("div",{className:"Form-group"},m("label",null,"qa"===this.editedEntry.type?"Answer":"Content"),m("div",{className:"FormControl-container"},m("textarea",{className:"FormControl",rows:"5",value:this.editedEntry.answer,oninput:function(e){t.editedEntry.answer=e.target.value}})),m("div",{className:"helpText"},"Current content length: ",(this.editedEntry.answer||"").length," characters")),m("div",{className:"Form-group"},m("label",null,"Keywords (comma separated)"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",value:this.editedEntry.keywords,oninput:function(e){t.editedEntry.keywords=e.target.value}})),m("div",{className:"helpText"},"Adding keywords helps the AI match relevant content more accurately",m("br",null),"Current keywords: ",this.editedEntry.keywords||"(None)")),this.categories.length>0&&m("div",{className:"Form-group"},m("label",null,"Category"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.editedEntry.category_id,onchange:function(e){t.editedEntry.category_id=e.target.value?parseInt(e.target.value):null}},m("option",{value:""},"-- Select Category --"),this.categories.map((function(t){return m("option",{value:t.id,key:t.id},t.name)}))))),m("div",{className:"Form-group"},m(l(),{className:"Button Button--primary",type:"submit",onclick:function(){console.log("Saving edited entry:",JSON.stringify(t.editedEntry)),t.attrs.onsubmit(t.editedEntry),t.hide()}},"Save Changes"))))},e}(o()),g=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var s=e.prototype;return s.oninit=function(e){t.prototype.oninit.call(this,e),this.loading=!0,this.entries=[],this.categories=[],this.newEntry={type:"qa",question:"",answer:"",keywords:"",category_id:null},this.newCategory={name:"",description:""},this.loadEntries(),this.loadCategories()},s.className=function(){return"KnowledgeBaseSettingsModal Modal--large"},s.title=function(){return"Knowledge Base Management"},s.loadEntries=function(){var t=this;this.loading=!0,a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/ai-support/kb"}).then((function(e){t.entries=e.data||[],t.loading=!1,m.redraw()})).catch((function(e){t.loading=!1,a().alerts.show({type:"error"},"Failed to load knowledge base entries: "+e.message),m.redraw()}))},s.loadCategories=function(){var t=this;a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/ai-support/kb/categories"}).then((function(e){t.categories=e.data||[],m.redraw()})).catch((function(t){a().alerts.show({type:"error"},"Failed to load knowledge base categories: "+t.message)}))},s.saveEntry=function(){var t=this;this.validateEntry()&&(this.loading=!0,a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/ai-support/kb",body:{data:{attributes:this.newEntry}}}).then((function(e){t.newEntry={type:"qa",question:"",answer:"",keywords:"",category_id:null},t.loadEntries(),a().alerts.show({type:"success"},"Knowledge base entry has been added")})).catch((function(e){t.loading=!1,a().alerts.show({type:"error"},"Failed to add knowledge base entry: "+e.message),m.redraw()})))},s.validateEntry=function(){return"qa"!==this.newEntry.type||this.newEntry.question?!!this.newEntry.answer||(a().alerts.show({type:"error"},"Answer/content cannot be empty"),!1):(a().alerts.show({type:"error"},"Question is required for Q&A type entries"),!1)},s.getEntryType=function(t){return t.attributes&&t.attributes.type?t.attributes.type:t.type&&"kb-entries"!==t.type?t.type:"qa"},s.getEntryTitle=function(t){var e;if("qa"===this.getEntryType(t))return t.question||(null==(e=t.attributes)?void 0:e.question)||"(No question)";var a,s=t.question||(null==(a=t.attributes)?void 0:a.question);if(s)return s;var n=this.getEntryContent(t);if(n&&"(No content)"!==n){var r,o=n.substring(0,30)+(n.length>30?"...":""),i=t.keywords||(null==(r=t.attributes)?void 0:r.keywords);if(i){var l=i.split(",")[0].trim();if(l)return l+": "+o}return o}return"(No title)"},s.getEntryContent=function(t){var e,a;return t.answer||(null==(e=t.attributes)?void 0:e.answer)||t.content||(null==(a=t.attributes)?void 0:a.content)||"(No content)"},s.getEntryKeywords=function(t){var e;return t.keywords||(null==(e=t.attributes)?void 0:e.keywords)||"(None)"},s.editEntry=function(t){var e=this;a().modal.show(p,{entry:t,categories:this.categories,onsubmit:function(s){e.loading=!0,a().request({method:"PATCH",url:a().forum.attribute("apiUrl")+"/ai-support/kb/"+t.id,body:{data:{attributes:s}}}).then((function(s){var n=e.entries.findIndex((function(e){return e.id===t.id}));-1!==n&&(e.entries[n]=s.data),e.loading=!1,a().alerts.show({type:"success"},"Knowledge base entry has been updated"),m.redraw()})).catch((function(t){e.loading=!1,a().alerts.show({type:"error"},"Failed to update knowledge base entry: "+t.message),m.redraw()}))}})},s.deleteEntry=function(t){var e=this;a().modal.show(c,{entry:t,onconfirm:function(){e.loading=!0,a().request({method:"DELETE",url:a().forum.attribute("apiUrl")+"/ai-support/kb/"+t.id}).then((function(){e.entries=e.entries.filter((function(e){return e.id!==t.id})),e.loading=!1,a().alerts.show({type:"success"},"Knowledge base entry has been deleted"),m.redraw()})).catch((function(t){e.loading=!1,a().alerts.show({type:"error"},"Failed to delete knowledge base entry: "+t.message),m.redraw()}))}})},s.content=function(){var t=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("h3",null,"Add Knowledge Base Entry"),m("div",{className:"Form-group"},m("label",null,"Type"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.newEntry.type,onchange:function(e){t.newEntry.type=e.target.value,m.redraw()}},m("option",{value:"qa"},"Q&A Type"),m("option",{value:"content"},"Content Type")))),"qa"===this.newEntry.type&&m("div",{className:"Form-group"},m("label",null,"Question"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",value:this.newEntry.question,oninput:function(e){t.newEntry.question=e.target.value}}))),"content"===this.newEntry.type&&m("div",{className:"Form-group"},m("label",null,"Title (Optional)"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",value:this.newEntry.question,placeholder:"Optional title for content entry",oninput:function(e){t.newEntry.question=e.target.value}})),m("div",{className:"helpText"},"Adding a title helps the AI match relevant content more accurately")),m("div",{className:"Form-group"},m("label",null,"qa"===this.newEntry.type?"Answer":"Content"),m("div",{className:"FormControl-container"},m("textarea",{className:"FormControl",rows:"5",value:this.newEntry.answer,oninput:function(e){t.newEntry.answer=e.target.value}}))),m("div",{className:"Form-group"},m("label",null,"Keywords (comma separated)"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",value:this.newEntry.keywords,oninput:function(e){t.newEntry.keywords=e.target.value}})),m("div",{className:"helpText"},"Adding keywords helps the AI match relevant content more accurately")),this.categories.length>0&&m("div",{className:"Form-group"},m("label",null,"Category"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.newEntry.category_id,onchange:function(e){t.newEntry.category_id=e.target.value?parseInt(e.target.value):null}},m("option",{value:""},"-- Select Category --"),this.categories.map((function(t){return m("option",{value:t.id,key:t.id},t.name)}))))),m("div",{className:"Form-group"},m(l(),{className:"Button Button--primary",loading:this.loading,onclick:function(){return t.saveEntry()}},"Add Entry"))),m("div",{className:"Form-group"},m("h3",null,"Knowledge Base Entries"),this.loading&&m(d(),null),!this.loading&&0===this.entries.length&&m("div",{className:"helpText"},"No knowledge base entries found. Add your first entry above."),!this.loading&&this.entries.length>0&&m("div",{className:"KnowledgeBaseEntries"},m("table",{className:"KnowledgeBaseEntries-table"},m("thead",null,m("tr",null,m("th",null,"Type"),m("th",null,"Question/Title"),m("th",null,"Answer/Content"),m("th",null,"Keywords"),m("th",null,"Actions"))),m("tbody",null,this.entries.map((function(e){return m("tr",{key:e.id},m("td",null,"qa"===t.getEntryType(e)?"Q&A":"Content"),m("td",null,t.getEntryTitle(e)),m("td",null,m("div",{className:"KnowledgeBaseEntries-content"},t.getEntryContent(e))),m("td",null,t.getEntryKeywords(e)),m("td",null,m("div",{className:"ButtonGroup"},m(l(),{className:"Button Button--icon",icon:"fas fa-edit",onclick:function(){return t.editEntry(e)},title:"Edit"}),m(l(),{className:"Button Button--icon",icon:"fas fa-trash",onclick:function(){return t.deleteEntry(e)},title:"Delete"}))))}))))))))},e}(o());const h=flarum.core.compat["admin/components/ExtensionPage"];var y=t.n(h);const v=flarum.core.compat["common/components/Switch"];var w=t.n(v);const f=flarum.core.compat["common/components/Dropdown"];var b=t.n(f);const N=flarum.core.compat["common/helpers/icon"];var S=t.n(N);function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=Array(e);a<e;a++)s[a]=t[a];return s}var _=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var s=e.prototype;return s.oninit=function(e){t.prototype.oninit.call(this,e),this.loading=!0,this.stats=null,this.period="all",this.sortBy="total_count",this.sortDir="desc",this.searchQuery="",this.error=null,this.loadStats()},s.className=function(){return"AiUsageStatsModal Modal--large Modal--dark"},s.title=function(){return a().translator.trans("leot-ai-support-widget.admin.usage_stats.title")},s.loadStats=function(){var t=this;this.loading=!0,this.error=null,a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/ai-support/stats",params:{period:this.period}}).then((function(e){t.stats=e,t.loading=!1,m.redraw()})).catch((function(e){t.loading=!1,t.error=e,a().alerts.show({type:"error"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.load_error")),m.redraw()}))},s.changePeriod=function(t){this.period=t,this.loadStats()},s.sortUsers=function(t){this.sortBy===t?this.sortDir="asc"===this.sortDir?"desc":"asc":(this.sortBy=t,this.sortDir="desc"),m.redraw()},s.getUserStats=function(){return this.stats&&this.stats.meta&&this.stats.meta.user_stats&&Array.isArray(this.stats.meta.user_stats)?this.stats.meta.user_stats:this.stats&&this.stats.user_stats&&Array.isArray(this.stats.user_stats)?this.stats.user_stats:[{user_id:1,username:"admin",display_name:"管理员(硬编码测试数据)",total_count:25,last_used:(new Date).toISOString()},{user_id:2,username:"test_user",display_name:"测试用户(硬编码测试数据)",total_count:10,last_used:new Date(Date.now()-864e5).toISOString()}]},s.getSortedUsers=function(){var t=this,e=this.getUserStats(),a=e;if(this.searchQuery){var s=this.searchQuery.toLowerCase();a=e.filter((function(t){return t.username.toLowerCase().includes(s)||t.display_name&&t.display_name.toLowerCase().includes(s)}))}return a.sort((function(e,a){var s=e[t.sortBy],n=a[t.sortBy];return"last_used"===t.sortBy&&(s=new Date(s).getTime(),n=new Date(n).getTime()),"asc"===t.sortDir?s>n?1:-1:s<n?1:-1}))},s.getSortIcon=function(t){return this.sortBy!==t?"":"asc"===this.sortDir?S()("fas fa-sort-up"):S()("fas fa-sort-down")},s.content=function(){var t=this;if(this.loading)return m("div",{className:"Modal-body"},m(d(),null));if(this.error)return m("div",{className:"Modal-body"},m("div",{className:"AiUsageStats-error"},m("p",null,a().translator.trans("leot-ai-support-widget.admin.usage_stats.load_error")),m("pre",null,JSON.stringify(this.error,null,2)),m(l(),{className:"Button Button--primary",onclick:function(){return t.loadStats()}},a().translator.trans("leot-ai-support-widget.admin.usage_stats.retry"))));if(!this.stats)return m("div",{className:"Modal-body"},m("div",{className:"AiUsageStats-error"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.no_data")));var e=this.getSortedUsers(),s=0,n=0,r=0,o=e.length;if(this.stats.data&&Array.isArray(this.stats.data))for(var i,u=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return(a=a.call(t)).next.bind(a);if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return A(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?A(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var s=0;return function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.stats.data);!(i=u()).done;){var c=i.value;if(c&&c.attributes){s=c.attributes.total_usage||s,n=c.attributes.today_usage||n,r=c.attributes.yesterday_usage||r,o=c.attributes.active_users||o;break}}return m("div",{className:"Modal-body"},m("div",{className:"AiUsageStats"},m("div",{className:"AiUsageStats-summary"},m("div",{className:"AiUsageStats-summaryItem"},m("div",{className:"AiUsageStats-summaryValue"},s),m("div",{className:"AiUsageStats-summaryLabel"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.total_usage"))),m("div",{className:"AiUsageStats-summaryItem"},m("div",{className:"AiUsageStats-summaryValue"},n),m("div",{className:"AiUsageStats-summaryLabel"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.today_usage"))),m("div",{className:"AiUsageStats-summaryItem"},m("div",{className:"AiUsageStats-summaryValue"},r),m("div",{className:"AiUsageStats-summaryLabel"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.yesterday_usage"))),m("div",{className:"AiUsageStats-summaryItem"},m("div",{className:"AiUsageStats-summaryValue"},o),m("div",{className:"AiUsageStats-summaryLabel"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.active_users")))),m("div",{className:"AiUsageStats-filters"},m("div",{className:"AiUsageStats-periodFilter"},m(b(),{label:a().translator.trans("leot-ai-support-widget.admin.usage_stats.period."+this.period),buttonClassName:"Button Button--primary"},m(l(),{className:"Dropdown-item",onclick:function(){return t.changePeriod("all")},active:"all"===this.period},a().translator.trans("leot-ai-support-widget.admin.usage_stats.period.all")),m(l(),{className:"Dropdown-item",onclick:function(){return t.changePeriod("today")},active:"today"===this.period},a().translator.trans("leot-ai-support-widget.admin.usage_stats.period.today")),m(l(),{className:"Dropdown-item",onclick:function(){return t.changePeriod("yesterday")},active:"yesterday"===this.period},a().translator.trans("leot-ai-support-widget.admin.usage_stats.period.yesterday")),m(l(),{className:"Dropdown-item",onclick:function(){return t.changePeriod("week")},active:"week"===this.period},a().translator.trans("leot-ai-support-widget.admin.usage_stats.period.week")),m(l(),{className:"Dropdown-item",onclick:function(){return t.changePeriod("month")},active:"month"===this.period},a().translator.trans("leot-ai-support-widget.admin.usage_stats.period.month")))),m("div",{className:"AiUsageStats-search"},m("input",{type:"text",className:"FormControl",placeholder:a().translator.trans("leot-ai-support-widget.admin.usage_stats.search_placeholder"),value:this.searchQuery,oninput:function(e){t.searchQuery=e.target.value,m.redraw()}})),m("div",{className:"AiUsageStats-refresh"},m(l(),{className:"Button Button--icon",icon:"fas fa-sync-alt",onclick:function(){return t.loadStats()},title:a().translator.trans("leot-ai-support-widget.admin.usage_stats.refresh")}))),m("div",{className:"AiUsageStats-table"},m("table",{className:"Table"},m("thead",null,m("tr",null,m("th",{className:"AiUsageStats-tableHeader AiUsageStats-userColumn",onclick:function(){return t.sortUsers("username")}},a().translator.trans("leot-ai-support-widget.admin.usage_stats.table.user"),this.getSortIcon("username")),m("th",{className:"AiUsageStats-tableHeader AiUsageStats-countColumn",onclick:function(){return t.sortUsers("total_count")}},a().translator.trans("leot-ai-support-widget.admin.usage_stats.table.count"),this.getSortIcon("total_count")),m("th",{className:"AiUsageStats-tableHeader AiUsageStats-dateColumn",onclick:function(){return t.sortUsers("last_used")}},a().translator.trans("leot-ai-support-widget.admin.usage_stats.table.last_used"),this.getSortIcon("last_used")))),m("tbody",null,0===e.length?m("tr",null,m("td",{colSpan:"3",className:"AiUsageStats-noUsers"},a().translator.trans("leot-ai-support-widget.admin.usage_stats.no_users"))):e.map((function(t){return m("tr",{key:t.user_id},m("td",{className:"AiUsageStats-userCell"},t.display_name||t.username),m("td",{className:"AiUsageStats-countCell"},t.total_count),m("td",{className:"AiUsageStats-dateCell"},new Date(t.last_used).toLocaleDateString()))})))))))},e}(o()),E=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var s=e.prototype;return s.oninit=function(e){t.prototype.oninit.call(this,e)},s.content=function(){return m("div",{className:"AiSettingsPage"},m("div",{className:"container"},this.buildSettingsForm()))},s.buildSettingsForm=function(){var t=this;return m("div",{className:"Form"},m("h2",null,"AI Support Widget Settings"),m("div",{className:"Form-group"},m("label",null,"Enable AI Support Widget"),m(w(),{state:this.setting("leot-ai-support-widget.enabled")(),onchange:this.setting("leot-ai-support-widget.enabled")},"Enable AI Support Widget"),m("div",{className:"helpText"},"Turn on or off the AI support widget on your forum.")),m("div",{className:"Form-group"},m("label",null,"AI Provider"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.setting("leot-ai-support-widget.provider")(),onchange:function(e){return t.setting("leot-ai-support-widget.provider")(e.target.value)}},m("option",{value:"openai"},"OpenAI ChatGPT"),m("option",{value:"deepseek"},"DeepSeek"),m("option",{value:"claude"},"Claude"),m("option",{value:"gemini"},"Gemini"))),m("div",{className:"helpText"},"Select which AI provider to use for the support widget.")),m("div",{className:"Form-group"},m("label",null,"API Key"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"password",bidi:this.setting("leot-ai-support-widget.api_key")})),m("div",{className:"helpText"},"Enter your API key for the selected AI provider.")),m("h3",null,"Proxy Settings"),m("div",{className:"Form-group"},m(w(),{state:this.setting("leot-ai-support-widget.openai_use_proxy")(),onchange:this.setting("leot-ai-support-widget.openai_use_proxy")},"Enable Proxy for OpenAI"),m("div",{className:"helpText"},"Enable proxy connection for OpenAI API requests.")),m("div",{className:"Form-group"},m("label",null,"Proxy Host"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",placeholder:"127.0.0.1",bidi:this.setting("leot-ai-support-widget.proxy_host")})),m("div",{className:"helpText"},"Proxy server host address (default: 127.0.0.1).")),m("div",{className:"Form-group"},m("label",null,"Proxy Port"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"number",min:"1",max:"65535",placeholder:"7890",bidi:this.setting("leot-ai-support-widget.proxy_port")})),m("div",{className:"helpText"},"Proxy server port number (default: 7890).")),m("div",{className:"Form-group"},m("label",null,"Model Name"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"text",placeholder:"gpt-3.5-turbo, deepseek-chat...",bidi:this.setting("leot-ai-support-widget.model_name")})),m("div",{className:"helpText"},"Enter the model name to use (e.g., gpt-3.5-turbo, deepseek-chat).")),m("div",{className:"Form-group"},m("label",null,"Max Tokens"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"number",min:"100",max:"4000",bidi:this.setting("leot-ai-support-widget.max_tokens")})),m("div",{className:"helpText"},"Maximum number of tokens to generate in AI responses.")),m("div",{className:"Form-group"},m("label",null,"Request Timeout"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"number",min:"5",max:"120",bidi:this.setting("leot-ai-support-widget.timeout")})),m("div",{className:"helpText"},"Timeout in seconds for AI API requests.")),m("h3",null,"Usage Limit Settings"),m("div",{className:"Form-group"},m("label",null,"Daily Requests Limit"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"number",min:"1",bidi:this.setting("leot-ai-support-widget.daily_requests_limit")})),m("div",{className:"helpText"},"Maximum number of AI requests per user per day.")),m("div",{className:"Form-group"},m("label",null,"Usage Statistics"),m("button",{className:"Button",type:"button",onclick:function(){return a().modal.show(_)}},"View Usage Statistics"),m("div",{className:"helpText"},"View detailed statistics about AI usage by users.")),m("h3",null,"Content Settings"),m("div",{className:"Form-group"},m(w(),{state:this.setting("leot-ai-support-widget.enable_indexing")(),onchange:this.setting("leot-ai-support-widget.enable_indexing")},"Enable Forum Content Indexing"),m("div",{className:"helpText"},"Allow AI to search and reference forum content.")),m("div",{className:"Form-group"},m("label",null,"Search Result Limit"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"number",min:"1",max:"20",bidi:this.setting("leot-ai-support-widget.search_limit")})),m("div",{className:"helpText"},"Maximum number of search results to include in AI context.")),m("h3",null,"Knowledge Base Settings"),m("div",{className:"Form-group"},m(w(),{state:this.setting("leot-ai-support-widget.kb_enabled")(),onchange:this.setting("leot-ai-support-widget.kb_enabled")},"Enable Knowledge Base"),m("div",{className:"helpText"},"Enable knowledge base to provide reference information for AI responses.")),m("div",{className:"Form-group"},m("label",null,"Knowledge Base Search Weight"),m("div",{className:"FormControl-container"},m("input",{className:"FormControl",type:"number",step:"0.1",min:"0.1",max:"5",bidi:this.setting("leot-ai-support-widget.kb_search_weight")})),m("div",{className:"helpText"},"Higher values prioritize knowledge base content in AI responses.")),m("div",{className:"Form-group"},m("button",{className:"Button",type:"button",onclick:function(){return t.showKnowledgeBaseModal()}},"Manage Knowledge Base Entries"),m("div",{className:"helpText"},"Add, edit, or remove knowledge base entries for AI assistant.")),m("h3",null,"Widget Settings"),m("div",{className:"Form-group"},m("label",null,"Widget Position"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.setting("leot-ai-support-widget.widget_position")(),onchange:function(e){return t.setting("leot-ai-support-widget.widget_position")(e.target.value)}},m("option",{value:"bottom-right"},"Bottom Right"),m("option",{value:"bottom-left"},"Bottom Left"))),m("div",{className:"helpText"},"Choose where the AI support widget should appear on the page.")),m("div",{className:"Form-group"},m("label",null,"Theme"),m("div",{className:"Select"},m("select",{className:"FormControl",value:this.setting("leot-ai-support-widget.theme")(),onchange:function(e){return t.setting("leot-ai-support-widget.theme")(e.target.value)}},m("option",{value:"light"},"Light"),m("option",{value:"dark"},"Dark"),m("option",{value:"auto"},"Auto (Follow System)"))),m("div",{className:"helpText"},"Choose the theme for the AI support widget.")),this.submitButton())},s.showKnowledgeBaseModal=function(){a().modal.show(g)},e}(y());a().initializers.add("leot-ai-support-widget",(function(){a().extensionData.for("leot-ai-support-widget").registerSetting({setting:"leot-ai-support-widget.enabled",type:"boolean",label:"Enable AI Support Widget",default:!0}).registerSetting({setting:"leot-ai-support-widget.provider",type:"select",label:"AI Provider",options:{openai:"OpenAI ChatGPT",deepseek:"DeepSeek",claude:"Claude",gemini:"Gemini"},default:"openai"}).registerSetting({setting:"leot-ai-support-widget.api_key",type:"text",label:"API Key"}).registerSetting({setting:"leot-ai-support-widget.model_name",type:"text",label:"Model Name",default:"gpt-3.5-turbo",placeholder:"gpt-3.5-turbo, deepseek-chat..."}).registerSetting({setting:"leot-ai-support-widget.max_tokens",type:"number",label:"Max Tokens",default:500,min:100,max:4e3}).registerSetting({setting:"leot-ai-support-widget.timeout",type:"number",label:"Request Timeout",help:"Timeout in seconds for AI API requests",default:15,min:5,max:120}).registerSetting((function(){return m("h3",null,"Usage Limit Settings")})).registerSetting({setting:"leot-ai-support-widget.daily_requests_limit",type:"number",label:"Daily Requests Limit",help:"Maximum number of AI requests per user per day",default:20,min:1,onchange:function(t){var e=parseInt(t,10);return isNaN(e)||e<1?(a().alerts.show({type:"error"},"Daily request limit must be at least 1"),1):e}}).registerSetting({setting:"leot-ai-support-widget.usage_stats",type:"custom",component:function(){return m("div",{className:"Form-group"},m("label",null,"Usage Statistics"),m("button",{className:"Button",onclick:function(){return a().modal.show(_)}},"View Usage Statistics"),m("div",{className:"helpText"},"View detailed statistics about AI usage by users"))}}).registerSetting((function(){return m("h3",null,"Content Settings")})).registerSetting({setting:"leot-ai-support-widget.enable_indexing",type:"boolean",label:"Enable Forum Content Indexing",help:"Allow AI to search and reference forum content",default:!0}).registerSetting({setting:"leot-ai-support-widget.search_limit",type:"number",label:"Search Result Limit",help:"Maximum number of search results to include in AI context",default:10,min:1,max:20}).registerSetting((function(){return m("h3",null,"Knowledge Base Settings")})).registerSetting({setting:"leot-ai-support-widget.kb_enabled",type:"boolean",label:"Enable Knowledge Base",default:!0}).registerSetting({setting:"leot-ai-support-widget.kb_search_weight",type:"number",label:"Knowledge Base Search Weight",help:"Higher values prioritize knowledge base content in AI responses",default:1.5,min:.1,max:5,step:.1}).registerSetting({label:"Knowledge Base Management",setting:"leot-ai-support-widget.kb_management",type:"custom",component:function(){return m("div",{className:"Form-group"},m("button",{className:"Button",onclick:function(){return a().modal.show(g)}},"Manage Knowledge Base Entries"),m("div",{className:"helpText"},"Add, edit, or remove knowledge base entries for AI assistant"))}}).registerSetting((function(){return m("h3",null,"Widget Settings")})).registerSetting({setting:"leot-ai-support-widget.widget_position",type:"select",label:"Widget Position",options:{"bottom-right":"Bottom Right","bottom-left":"Bottom Left"},default:"bottom-right"}).registerSetting({setting:"leot-ai-support-widget.theme",type:"select",label:"Theme",options:{light:"Light",dark:"Dark",auto:"Auto (Follow System)"},default:"auto"}).registerPermission({icon:"fas fa-robot",label:"Use AI Support",permission:"leot-ai-support-widget.use",allowGuest:!1},"start").registerPermission({icon:"fas fa-database",label:"Manage knowledge base",permission:"leot-ai-support-widget.manageKnowledgeBase",allowGuest:!1},"moderate"),a().extensionData.for("leot-ai-support-widget").registerPage(E)}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map